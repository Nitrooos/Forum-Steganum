module.exports "algorithm", content: """!function(e,t){"function"==typeof define&&define.amd?define([],t):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t():(e.dcodeIO=e.dcodeIO||{}).Long=t()}(this,function(){function i(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function n(t){return!0===(t&&t.__isLong__)}function w(t,e){return e?0<=(t>>>=0)&&256>t:-128<=(t|=0)&&128>t}function u(t,r){var i,n;if(r){if((n=w(t>>>=0,!0))&&(i=p[t]))return i;i=e(t,0>(0|t)?-1:0,!0),n&&(p[t]=i)}else{if((n=w(t|=0,!1))&&(i=m[t]))return i;i=e(t,0>t?-1:0,!1),n&&(m[t]=i)}return i}function o(t,i){if(isNaN(t)||!isFinite(t))return i?g:a;if(i){if(0>t)return g;if(t>=f)return I}else{if(-v>=t)return r;if(t+1>=v)return b}return 0>t?o(-t,i).neg():e(t%4294967296|0,t/4294967296|0,i)}function e(t,e,n){return new i(t,e,n)}function l(t,n,e){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return a;if("number"==typeof n&&(e=n,n=!1),e=e||10,2>e||e>36)throw RangeError("radix");var u;if(0<(u=t.indexOf("-")))throw Error("interior hyphen");if(0===u)return l(t.substring(1),n,e).neg();u=o(d(e,8));for(var i=a,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),h=parseInt(t.substring(r,r+s),e);8>s?(s=o(d(e,s)),i=i.mul(s).add(o(h))):(i=i.mul(u),i=i.add(o(h)))}return i.unsigned=n,i}function s(t){return t instanceof i?t:"number"==typeof t?o(t):"string"==typeof t?l(t):e(t.low,t.high,t.unsigned)}Object.defineProperty(i.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),i.isLong=n;var m={},p={};i.fromInt=u,i.fromNumber=o,i.fromBits=e;var d=Math.pow;i.fromString=l,i.fromValue=s;var f=0x10000000000000000,v=f/2,N=u(16777216),a=u(0);i.ZERO=a;var g=u(0,!0);i.UZERO=g;var h=u(1);i.ONE=h;var t=u(1,!0);i.UONE=t;var c=u(-1);i.NEG_ONE=c;var b=e(-1,2147483647,!1);i.MAX_VALUE=b;var I=e(-1,-1,!0);i.MAX_UNSIGNED_VALUE=I;var r=e(0,-2147483648,!1);return i.MIN_VALUE=r,t=i.prototype,t.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.toNumber=function(){return this.unsigned?4294967296*(this.high>>>0)+(this.low>>>0):4294967296*this.high+(this.low>>>0)},t.toString=function(t){if(t=t||10,2>t||t>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(r)){var e=o(t),n=this.div(e),e=n.mul(e).sub(this);return n.toString(t)+e.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var n=o(d(t,6),this.unsigned),e=this,a="";;){var s=e.div(n),i=(e.sub(s.mul(n)).toInt()>>>0).toString(t),e=s;if(e.isZero())return i+a;for(;6>i.length;)i="0"+i;a=""+i+a}},t.getHighBits=function(){return this.high},t.getHighBitsUnsigned=function(){return this.high>>>0},t.getLowBits=function(){return this.low},t.getLowBitsUnsigned=function(){return this.low>>>0},t.getNumBitsAbs=function(){if(this.isNegative())return this.eq(r)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},t.isZero=function(){return 0===this.high&&0===this.low},t.isNegative=function(){return!this.unsigned&&0>this.high},t.isPositive=function(){return this.unsigned||0<=this.high},t.isOdd=function(){return 1===(1&this.low)},t.isEven=function(){return 0===(1&this.low)},t.equals=function(t){return n(t)||(t=s(t)),this.unsigned!==t.unsigned&&1===this.high>>>31&&1===t.high>>>31?!1:this.high===t.high&&this.low===t.low},t.eq=t.equals,t.notEquals=function(t){return!this.eq(t)},t.neq=t.notEquals,t.lessThan=function(t){return 0>this.comp(t)},t.lt=t.lessThan,t.lessThanOrEqual=function(t){return 0>=this.comp(t)},t.lte=t.lessThanOrEqual,t.greaterThan=function(t){return 0<this.comp(t)},t.gt=t.greaterThan,t.greaterThanOrEqual=function(t){return 0<=this.comp(t)},t.gte=t.greaterThanOrEqual,t.compare=function(t){if(n(t)||(t=s(t)),this.eq(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},t.comp=t.compare,t.negate=function(){return!this.unsigned&&this.eq(r)?r:this.not().add(h)},t.neg=t.negate,t.add=function(t){n(t)||(t=s(t));var o,a=this.high>>>16,i=65535&this.high,r=this.low>>>16,u=t.high>>>16,h=65535&t.high,g=t.low>>>16;return o=0+((65535&this.low)+(65535&t.low)),t=0+(o>>>16),t+=r+g,r=0+(t>>>16),r+=i+h,i=0+(r>>>16),i=i+(a+u)&65535,e((65535&t)<<16|65535&o,i<<16|65535&r,this.unsigned)},t.subtract=function(t){return n(t)||(t=s(t)),this.add(t.neg())},t.sub=t.subtract,t.multiply=function(t){if(this.isZero())return a;if(n(t)||(t=s(t)),t.isZero())return a;if(this.eq(r))return t.isOdd()?r:a;if(t.eq(r))return this.isOdd()?r:a;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(N)&&t.lt(N))return o(this.toNumber()*t.toNumber(),this.unsigned);var v=this.high>>>16,f=65535&this.high,d=this.low>>>16,g=65535&this.low,w=t.high>>>16,m=65535&t.high,c=t.low>>>16;t=65535&t.low;var h,i,u,l;return l=0+g*t,u=0+(l>>>16),u+=d*t,i=0+(u>>>16),u=(65535&u)+g*c,i+=u>>>16,u&=65535,i+=f*t,h=0+(i>>>16),i=(65535&i)+d*c,h+=i>>>16,i&=65535,i+=g*m,h+=i>>>16,i&=65535,h=h+(v*t+f*c+d*m+g*w)&65535,e(u<<16|65535&l,h<<16|i,this.unsigned)},t.mul=t.multiply,t.divide=function(t){if(n(t)||(t=s(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:a;var e,i,l;if(this.eq(r))return t.eq(h)||t.eq(c)?r:t.eq(r)?h:(e=this.shr(1).div(t).shl(1),e.eq(a)?t.isNegative()?h:c:(i=this.sub(t.mul(e)),l=e.add(i.div(t))));if(t.eq(r))return this.unsigned?g:a;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();for(l=a,i=this;i.gte(t);){e=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var m=Math.ceil(Math.log(e)/Math.LN2),m=48>=m?1:d(2,m-48),u=o(e),f=u.mul(t);f.isNegative()||f.gt(i);)e-=m,u=o(e,this.unsigned),f=u.mul(t);u.isZero()&&(u=h),l=l.add(u),i=i.sub(f)}return l},t.div=t.divide,t.modulo=function(t){return n(t)||(t=s(t)),this.sub(this.div(t).mul(t))},t.mod=t.modulo,t.not=function(){return e(~this.low,~this.high,this.unsigned)},t.and=function(t){return n(t)||(t=s(t)),e(this.low&t.low,this.high&t.high,this.unsigned)},t.or=function(t){return n(t)||(t=s(t)),e(this.low|t.low,this.high|t.high,this.unsigned)},t.xor=function(t){return n(t)||(t=s(t)),e(this.low^t.low,this.high^t.high,this.unsigned)},t.shiftLeft=function(t){return n(t)&&(t=t.toInt()),0===(t&=63)?this:32>t?e(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e(0,this.low<<t-32,this.unsigned)},t.shl=t.shiftLeft,t.shiftRight=function(t){return n(t)&&(t=t.toInt()),0===(t&=63)?this:32>t?e(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},t.shr=t.shiftRight,t.shiftRightUnsigned=function(t){if(n(t)&&(t=t.toInt()),t&=63,0===t)return this;var i=this.high;return 32>t?e(this.low>>>t|i<<32-t,i>>>t,this.unsigned):32===t?e(i,0,this.unsigned):e(i>>>t-32,0,this.unsigned)},t.shru=t.shiftRightUnsigned,t.toSigned=function(){return this.unsigned?e(this.low,this.high,!1):this},t.toUnsigned=function(){return this.unsigned?this:e(this.low,this.high,!0)},i}),stegano=function(){function i(){return"function"!=typeof window.FileReader?(_write("The file API isn't supported on this browser yet."),!1):!0}function n(){if(!i())throw"Your browser cannot support stegano module! Update or install a modern browser!";t.integration=stegano.integration(),t.algorithm=stegano.algorithm(),t.image=stegano.image(),t.events=stegano.events(),t.helpers=stegano.helpers(),e=window.prompt("Type a password to unlock hiden content: ")}function r(e){return t[e]}function o(){return e}var t={},e="";return{run:n,module:r,secretPassword:o}}(),stegano.algorithm=function(){function e(r,i){for(var e=[],n=[],t=0;32>t;++t)e.push(i.charCodeAt(2*t)),e.push(i.charCodeAt(2*t+1));for(var t=0;32>t;++t)n.push(r[t]^e[t]);return n}var t={};return function(){t.hiding=stegano.algorithm.hiding(),t.retrieving=stegano.algorithm.retrieving(),t.random=stegano.algorithm.random()}(),{hiding:t.hiding.run,retrieving:t.retrieving.run,random:t.random,prepareSeed:e}},stegano.events=function(){function e(){if(t=this.checked?"Secret":"Normal",this.checked){var n=document.querySelectorAll(".post img");$(".post .live-edit, .post img").hide(),$("md-list-item:has(.post):not(:has(img))").hide();for(var e=0,r=n.length;r>e;++e)stegano.module("algorithm").retrieving(n[e]);$(".view-mode").text(t+" view")}else{for(var i=document.querySelectorAll(".secret-text"),e=0;e<i.length;++e)i[e].parentNode.removeChild(i[e]);$(".post .live-edit, .post img").show(),$("md-list-item:has(.post)").show(),$(".view-mode").text(t+" view"),$("html, body").animate({scrollTop:$(document).height()},"slow")}}function i(t){var e=stegano.module("integration").getSecretText();stegano.module("algorithm").hiding(e,t)}function n(){return t}var t="Normal";return{switchView:e,sendMessage:i,getViewMode:n}},stegano.helpers=function(){var t={};return function(){t.validation=stegano.helpers.validation()}(),{validation:t.validation}},stegano.image=function(){var t={};return function(){t.loader=stegano.image.loader(),t.access=stegano.image.access()}(),{loadFromFile:t.loader.loadImageFromFile,loadFromImg:t.loader.loadImageFromImgElement,save:t.loader.saveImage,getData:t.loader.getImageData,getPixel:t.access.getPixel,setPixel:t.access.setPixel}},stegano.integration=function(){function e(){t.canvas=stegano.integration.canvas(),t.textarea=stegano.integration.textarea(),t["switch"]=stegano.integration["switch"]()}function i(){return o}function n(){return void 0!==t.canvas?t.canvas.get():void 0}function r(){return void 0!==t.textarea?t.textarea.secretText():void 0}var t={},o={fileInput:'.new-post input[type="file"]',postInput:".new-post textarea",form:".new-post"};return{run:e,selectors:i,getCanvas:n,getSecretText:r}},stegano.algorithm.hiding=function(){function u(){t=stegano.module("image").getData();for(var r=t.width,o=t.height,i=0;o>i;++i)for(var n=0;r>n;++n){var a=2*Math.random()|0,s=2*Math.random()|0,u=2*Math.random()|0,e=stegano.module("image").getPixel(t,n,i);e.r=254&e.r|a,e.g=254&e.g|s,e.b=254&e.b|u,stegano.module("image").setPixel(t,n,i,e)}}function a(){var e;t=stegano.module("image").getData();do e=stegano.module("algorithm").random.get(0,t.width*t.height);while(-1!==i.indexOf(e));return i.push(e),e}function h(t,e){return t>>3*e&7}function g(e,n){var r=n%t.width,o=Math.floor(n/t.width),i=stegano.module("image").getPixel(t,r,o),a={r:254&i.r|(4&e)>>2,g:254&i.g|(2&e)>>1,b:254&i.b|1&e};stegano.module("image").setPixel(t,r,o,a)}function r(){for(var t=0,n=e.length;n>=t;++t){var r=0;t!=n&&(r=e.charCodeAt(t));for(var i=0;6>i;++i){var o=a(),s=h(r,i);g(s,o)}}}function o(t){var n=stegano.module("algorithm").prepareSeed(t,stegano.secretPassword());stegano.module("algorithm").random.seed(n),u(),r(),stegano.module("image").save(),i=[];var e=new FS.File(stegano.module("integration").getCanvas().toDataURL());return e.metadata={public_key:t},e}function d(){Meteor.call("setImagePublicKey",function(r,i){if(""!=e)var t=o(i);else var t=new FS.File(stegano.module("integration").getCanvas().toDataURL());t=Images.insert(t,function(e,i){e&&alertsServ.error(e),t&&t._id||alertsServ.error("Nie udało się wysłać obrazka na serwer!")}),n(t._id),"Secret"==stegano.module("events").getViewMode()&&stegano.module("algorithm").retrieving(document.querySelector('img[data-image-id="'+t._id+'"]'))})}function s(i,r){n=r;var t=stegano.module("helpers").validation.fileNameFromInput();t&&(e=i,stegano.module("image").loadFromFile(t,d))}var t,e,n,i=[];return{run:s}},stegano.algorithm.random=function(){function i(i){if(e=0,!(Object.prototype.toString.call(i)===Object.prototype.toString.call([])&&i.length>=32))throw"Seed must be an array with at least 32 integer values!";t=[];for(var n=0;16>n;++n)t.push(dcodeIO.Long.fromBits(i[2*n],i[2*n+1],!0))}function n(n,o){var r=dcodeIO.Long.fromValue(t[e]),i=dcodeIO.Long.fromValue(t[e=e+1&15]);i=i.xor(i.shl(31)),t[e]=i.xor(r).xor(i.shr(11)).xor(r.shr(30));var a=t[e].multiply(dcodeIO.Long.fromString("1181783497276652981",!0));return a.divide(dcodeIO.Long.MAX_UNSIGNED_VALUE.divide(o-n)).add(n).toInt()}var t=[],e=0;return{seed:i,get:n}},stegano.algorithm.retrieving=function(){function t(e){var t,i=stegano.module("image").getData();do t=stegano.module("algorithm").random.get(0,i.width*i.height);while(-1!==e.indexOf(t));return e.push(t),t}function e(i){var t=stegano.module("image").getData(),n=i%t.width,r=Math.floor(i/t.width),e=stegano.module("image").getPixel(t,n,r);return(1&e.r)<<2|(1&e.g)<<1|1&e.b}function i(a){var s="",u=0,h=[];do{for(var i=0,n=0;6>n;++n){var g=t(h),d=e(g);i|=d<<3*n}s+=String.fromCharCode(i),++u}while(0!==i&&r>u);var o=document.createElement("p");o.className="secret-text",o.appendChild(document.createTextNode(s)),a.parentNode.insertBefore(o,a)}function n(t){Meteor.call("getImagePublicKey",t.dataset.imageId,function(r,e){if(!e)return void $(t).closest("md-list-item").hide();var n=stegano.module("algorithm").prepareSeed(e,stegano.secretPassword());stegano.module("algorithm").random.seed(n),stegano.module("image").loadFromImg(t,i,[t])})}var r=1e3;return{run:n}},stegano.helpers.validation=function(){function t(e){var t=document.createElement("p");t.innerHTML=e,document.body.appendChild(t)}function e(){var e=document.querySelector(stegano.module("integration").selectors().fileInput);return e?e.files?e.files[0]?e.files[0]:(t("Please select a file before clicking 'Load'"),!1):(t("This browser doesn't seem to support the `files` property of file fileInputs."),!1):(t("Um, couldn't find the imgfile element."),!1)}return{fileNameFromInput:e}},stegano.image.access=function(){function t(t,n,r){if(n>t.width||r>t.height)throw"Arguments out of image dimensions";var e=t.data,i=4*(t.width*r+n),o={r:e[i+0],g:e[i+1],b:e[i+2],a:e[i+3]};return o}function e(n,r,o,t){if(!t)throw"None color to set specified";var e=n.data,i=4*(n.width*o+r);e[i+0]=t.r,e[i+1]=t.g,e[i+2]=t.b,e[i+3]=t.a||e[i+3]}return{getPixel:t,setPixel:e}},stegano.image.loader=function(){function a(){e=new Image,e.onload=o,e.src=i.result}function o(){t.width=e.naturalWidth,t.height=e.naturalHeight;var i=t.getContext("2d");i.drawImage(e,0,0),n=i.getImageData(0,0,t.width,t.height),r()}function s(e,n){r=n,t=stegano.module("integration").getCanvas(),i=new FileReader,i.onload=a,i.readAsDataURL(e)}function u(e,r,o){t=stegano.module("integration").getCanvas(),t.width=e.naturalWidth,t.height=e.naturalHeight;var i=t.getContext("2d");i.drawImage(e,0,0),n=i.getImageData(0,0,t.width,t.height),r.apply(void 0,o||[])}function h(){t.getContext("2d").putImageData(n,0,0)}function g(){return n}var i,e,n,t,r;return{loadImageFromFile:s,loadImageFromImgElement:u,saveImage:h,getImageData:g}},stegano.integration.canvas=function(){function e(){t=document.createElement("canvas"),t.setAttribute("style","display:none"),t.width=0,t.height=0,document.querySelector(stegano.module("integration").selectors().form).appendChild(t)}function i(){return t}var t;return function(){e()}(),{get:i}},stegano.integration["switch"]=function(){function i(){if(void 0!==e){var i=document.querySelector(e);t=document.createElement("div"),t.className="view-switch",t.innerHTML='<span class="view-mode">Normal view</span><div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch"><label class="onoffswitch-label" for="myonoffswitch"></label></div>',i.appendChild(t),$(".view-switch input").click(stegano.module("events").switchView)}}var t,e;!function(){e=stegano.module("integration").selectors().form,i()}()},stegano.integration.textarea=function(){function i(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function n(){if(void 0!==e){var n=document.querySelector(e);t=document.createElement("textarea"),t.setAttribute("maxlength","1000"),t["class"]="secret",t.placeholder="Type to add hidden content",i(t,n)}}function r(){return t.value}var e,t;return function(){e=stegano.module("integration").selectors().postInput,n()}(),{secretText:r}};stegano.run();"""