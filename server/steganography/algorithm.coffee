module.exports "algorithm", content: """stegano=function(){function t(){return"function"!=typeof window.FileReader?(_write("The file API isn't supported on this browser yet."),!1):!0}function n(){if(!t())throw"Your browser cannot support stegano module! Update or install a modern browser!";e.integration=stegano.integration(),e.algorithm=stegano.algorithm(),e.image=stegano.image(),e.events=stegano.events(),e.helpers=stegano.helpers()}function o(t){return e[t]}var e={};return{run:n,module:o}}(),stegano.algorithm=function(){var e={};return function(){e.hiding=stegano.algorithm.hiding(),e.retrieving=stegano.algorithm.retrieving(),e.random=stegano.algorithm.random()}(),{hiding:e.hiding.run,retrieving:e.retrieving.run,random:e.random}},stegano.events=function(){function t(){"normal"===e?e="secret":"secret"===e&&(e="normal")}function n(){var e=stegano.module("integration").getSecretText();stegano.module("algorithm").hiding(e),console.log("Secret text: "+e)}var e="normal";return{switchView:t,sendMessage:n}},stegano.helpers=function(){var e={};return function(){e.validation=stegano.helpers.validation()}(),{validation:e.validation}},stegano.image=function(){var e={};return function(){e.loader=stegano.image.loader(),e.access=stegano.image.access()}(),{load:e.loader.loadImage,save:e.loader.saveImage,getData:e.loader.getImageData,getPixel:e.access.getPixel,setPixel:e.access.setPixel}},stegano.integration=function(){function t(){e.canvas=stegano.integration.canvas(),e.input=stegano.integration.input(),e["switch"]=stegano.integration["switch"]()}function n(){return i}function o(){return void 0!==e.canvas?e.canvas.get():void 0}function a(){return void 0!==e.input?e.input.secretText():void 0}var e={},i={fileInput:'.new-post input[type="file"]',postInput:".new-post textarea",form:".new-post"};return{run:t,selectors:n,getCanvas:o,getSecretText:a}},stegano.algorithm.hiding=function(){function o(){e=stegano.module("image").getData();for(var a=e.width,i=e.height,n=0;i>n;++n)for(var o=0;a>o;++o){var r=2*Math.random()|0,g=2*Math.random()|0,u=2*Math.random()|0,t=stegano.module("image").getPixel(e,o,n);t.r=254&t.r|r,t.g=254&t.g|g,t.b=254&t.b|u,stegano.module("image").setPixel(e,o,n,t)}}function a(){var t;e=stegano.module("image").getData();do t=stegano.module("algorithm").random.get(0,e.width*e.height);while(-1!==n.indexOf(t));return n.push(t),t}function i(e,t){return e>>3*t&7}function r(t,o){var a=o%e.width,i=Math.floor(o/e.width),n=stegano.module("image").getPixel(e,a,i),r={r:254&n.r|(4&t)>>2,g:254&n.g|(2&t)>>1,b:254&n.b|1&t};stegano.module("image").setPixel(e,a,i,r)}function g(){for(var e=0,o=t.length;o>e;++e)for(var n=0;6>n;++n){var g=a(),u=i(t.charCodeAt(e),n);r(u,g)}}function u(){o(),g(),stegano.module("image").save()}function s(n){console.log("Hiding");var e=stegano.module("helpers").validation.fileNameFromInput();e&&(t=n,stegano.module("image").load(e,u))}var e,t,n=[];return{run:s}},stegano.algorithm.random=function(){function e(e){n=e}function t(e,t){return Math.floor(Math.random()*(t-e)+e)}var n;return{seed:e,get:t}},stegano.algorithm.retrieving=function(){function e(){console.log("Retrieving")}return{run:e}},stegano.helpers.validation=function(){function e(t){var e=document.createElement("p");e.innerHTML=t,document.body.appendChild(e)}function t(){var t=document.querySelector(stegano.module("integration").selectors().fileInput);return t?t.files?t.files[0]?t.files[0]:(e("Please select a file before clicking 'Load'"),!1):(e("This browser doesn't seem to support the `files` property of file fileInputs."),!1):(e("Um, couldn't find the imgfile element."),!1)}return{fileNameFromInput:t}},stegano.image.access=function(){function e(e,o,a){if(o>e.width||a>e.height)throw"Arguments out of image dimensions";var t=e.data,n=4*(e.width*a+o),i={r:t[n+0],g:t[n+1],b:t[n+2],a:t[n+3]};return i}function t(o,a,i,e){if(!e)throw"None color to set specified";var t=o.data,n=4*(o.width*i+a);t[n+0]=e.r,t[n+1]=e.g,t[n+2]=e.b,t[n+3]=e.a||t[n+3]}return{getPixel:e,setPixel:t}},stegano.image.loader=function(){function i(){t=new Image,t.onload=r,t.src=n.result}function r(){e.width=t.naturalWidth,e.height=t.naturalHeight;var n=e.getContext("2d");n.drawImage(t,0,0),o=n.getImageData(0,0,e.width,e.height),a()}function g(t,o){a=o,e=stegano.module("integration").getCanvas(),n=new FileReader,n.onload=i,n.readAsDataURL(t)}function u(){e.getContext("2d").putImageData(o,0,0)}function s(){return o}var n,t,o,e,a;return{loadImage:g,saveImage:u,getImageData:s}},stegano.integration.canvas=function(){function t(){e=document.createElement("canvas"),e.width=0,e.height=0,document.querySelector(stegano.module("integration").selectors().form).appendChild(e)}function n(){return e}var e;return function(){t()}(),{get:n}},stegano.integration.input=function(){function n(t,e){e.parentNode.insertBefore(t,e.nextSibling)}function o(){if(void 0!==t){var o=document.querySelector(t);e=document.createElement("input"),e["class"]="secret",e.type="text",n(e,o)}}function a(){return e.value}var t,e;return function(){t=stegano.module("integration").selectors().postInput,o()}(),{secretText:a}},stegano.integration["switch"]=function(){function n(){if(void 0!==t){var n=document.querySelector(t);e=document.createElement("input"),e.type="checkbox",n.appendChild(e)}}var e,t;!function(){t=stegano.module("integration").selectors().form,n()}()};stegano.run();"""